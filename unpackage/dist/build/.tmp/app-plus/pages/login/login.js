(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/login"],{"1caa":function(t,e,n){"use strict";n.r(e);var o=n("4353"),a=n.n(o);for(var i in o)"default"!==i&&function(t){n.d(e,t,function(){return o[t]})}(i);e["default"]=a.a},"30b4":function(t,e,n){"use strict";var o,a=function(){var t=this,e=t.$createElement;t._self._c;t._isMounted||(t.e0=function(e){!t.safety.state&&t.fnGetPhoneCode()})},i=[];n.d(e,"b",function(){return a}),n.d(e,"c",function(){return i}),n.d(e,"a",function(){return o})},3423:function(t,e,n){"use strict";var o=n("b1ae"),a=n.n(o);a.a},4353:function(t,e,n){"use strict";(function(t,o){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=n("2f62"),i=s(n("f42b"));function s(t){return t&&t.__esModule?t:{default:t}}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),o.forEach(function(e){r(t,e,n[e])})}return t}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var u=function(){return n.e("components/cmd-nav-bar/cmd-nav-bar").then(n.bind(null,"c3a4"))},l=function(){return n.e("components/cmd-page-body/cmd-page-body").then(n.bind(null,"45f9"))},f=function(){return n.e("components/cmd-transition/cmd-transition").then(n.bind(null,"be96"))},d=function(){return n.e("components/cmd-input/cmd-input").then(n.bind(null,"3ede"))},h={components:{cmdNavBar:u,cmdPageBody:l,cmdTransition:f,cmdInput:d},computed:(0,a.mapState)(["forcedLogin","serverUrl","user"]),data:function(){return{account:{username:"",password:""},usernameReg:/^[A-Za-z0-9]+$/,passwordReg:/^\w+$/,loginAccount:!1,mobile:{phone:"",code:""},phoneReg:/^[1](([3][0-9])|([4][5-9])|([5][0-3,5-9])|([6][5,6])|([7][0-8])|([8][0-9])|([9][1,8,9]))[0-9]{8}$/,loginMobile:!1,safety:{time:60,state:!1,interval:""},status:!0}},watch:{mobile:{handler:function(t){this.phoneReg.test(t.phone)&&6===t.code.length?this.loginMobile=!0:this.loginMobile=!1},deep:!0},account:{handler:function(t){this.usernameReg.test(t.username)&&t.username.length>=8&&this.passwordReg.test(t.password)&&t.password.length>=8?this.loginAccount=!0:this.loginAccount=!1},deep:!0}},methods:c({},(0,a.mapMutations)(["login","updateUser"]),{toMain:function(e){this.login(e),this.forcedLogin?t.reLaunch({url:"../main/main"}):t.navigateBack()},fnLogin:function(){var e=this;if(this.status){console.log(o(JSON.stringify(this.mobile)," at pages\\login\\login.vue:164"));var n=this.mobile,a=this;t.request({url:this.serverUrl+"/user/login/phone/"+n.phone+"/"+n.code,method:"POST",header:{},success:function(n){if(console.log(o(JSON.stringify(n.data)," at pages\\login\\login.vue:174")),n.data.status){t.showToast({icon:"success",title:"登录成功"});var i=n.data.message;try{console.log(o("token="+i," at pages\\login\\login.vue:182")),t.setStorageSync("token",i),a.updateUser(n.data.data)}catch(s){t.showToast({icon:"none",title:"登陆失败"})}e.toMain("")}else t.showToast({icon:"none",title:"登陆失败"})},fail:function(e){t.showToast({icon:"none",title:"登录失败"})}})}else{n=this.account,a=this;t.request({url:this.serverUrl+"/user/login/account",method:"POST",data:n,header:{"content-type":"application/json"},success:function(n){if(console.log(o(JSON.stringify(n.data)," at pages\\login\\login.vue:225")),n.data.status){t.showToast({icon:"success",title:"登录成功"});var i=n.data.message;try{console.log(o("token="+i," at pages\\login\\login.vue:236")),t.setStorageSync("token",i),a.updateUser(n.data.data)}catch(s){t.showToast({icon:"none",title:"登陆失败"})}e.toMain("")}else t.showToast({icon:"none",title:"登陆失败"})},fail:function(e){t.showToast({icon:"none",title:"登录失败"})}})}},fnGetPhoneCode:function(){var e=this;this.phoneReg.test(this.mobile.phone)?t.showToast({title:"正在发送验证码",icon:"loading",success:function(){var n={};n.url="/message/getYanzhengma/"+e.mobile.phone+"/login",i.default.get(n).then(function(n){t.showToast({icon:"none",title:"发送成功"}),e.safety.state=!0,e.safety.interval=setInterval(function(){e.safety.time--<=0&&(e.safety.time=60,e.safety.state=!1,clearInterval(e.safety.interval))},1e3)},function(e){t.showToast({icon:"none",title:"发送失败:"+e})})}}):t.showToast({title:"手机号不正确",icon:"none"})},fnChangeStatus:function(t){this.mobile={phone:"",code:""},this.loginMobile=!1,this.account={username:"",password:""},this.loginAccount=!1,clearInterval(this.safety.interval),this.safety.time=60,this.safety.state=!1,t||(this.status=!this.status)},fnRegisterWin:function(){t.navigateTo({url:"/pages/user/register/register"}),this.fnChangeStatus(!0)}}),beforeDestroy:function(){clearInterval(this.safety.interval)}};e.default=h}).call(this,n("6e42")["default"],n("0de9")["default"])},"53b3":function(t,e,n){"use strict";(function(t){n("daa0"),n("921b");o(n("66fd"));var e=o(n("d907"));function o(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,n("6e42")["createPage"])},b1ae:function(t,e,n){},d907:function(t,e,n){"use strict";n.r(e);var o=n("30b4"),a=n("1caa");for(var i in a)"default"!==i&&function(t){n.d(e,t,function(){return a[t]})}(i);n("3423");var s,c=n("f0c5"),r=Object(c["a"])(a["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],s);e["default"]=r.exports}},[["53b3","common/runtime","common/vendor"]]]);